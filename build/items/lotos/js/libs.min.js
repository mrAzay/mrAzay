function pageslider(e,s){var d,r,n,o,t,i,l=document.body,u=e.children,a=document.documentElement.clientHeight||window.innerHeight,c=window.location,m=c.hash,v=0,p=0,g=u[p],h=u.length-1,f=e.children.length,L=Math.round(f/2),E=.7,w=1e3*E,y=!1,A=document.getElementById("pageslider__to-top"),T=document.querySelector(".menu__links ul").children,b=document.getElementById("pageslider__for-text"),S=document.getElementById("b-navkey__prev"),D=document.querySelectorAll(".next-page__text"),_=["You can...","... add some text ...","... which depends of ...","... slide ...","Oliw Page Slider"],B="layout";if("layout"==B){B=[];for(var P=0;P<T.length;P++)k=T[P].querySelector("a").getAttribute("href"),B.push(k)}if(B){var k,C=/^#./;for(P=0;P<B.length;P++){if(m==(k=C.test(B[P])?B[P]:"#"+B[P])){g=u[p=P];break}P==B.length-1&&(c.hash=B[0])}}if(g.classList.add("active"),F(p),document.addEventListener("touchstart",function(e){t=e.changedTouches[0].clientY,Math.round(g.children[0].getBoundingClientRect().top)},!1),document.addEventListener("touchmove",function(e){e.changedTouches[0].clientY},!1),document.addEventListener("touchend",function(e){i=e.changedTouches[0],Math.abs(t-i.clientY),g.style.transform="",i.clientY<t?M(1):M(-1)},!1),document.addEventListener("keydown",function(e){var t,n=e.keyCode;38==(t=n)?(noActivePage=p,M(-1)):40==t&&(noActivePage=p,M(1))},!1),window.addEventListener("scrollDown",function(e){M(1)}),window.addEventListener("scrollUp",function(e){M(-1)}),window.addEventListener("resize",function(e){a=window.innerHeight||document.documentElement.clientHeight}),S&&(S.addEventListener("click",function(e){q()},!1),S.addEventListener("touchend",function(e){q()},!1)),D&&D.forEach(function(e){e.addEventListener("click",function(e){H()},!1),e.addEventListener("touchend",function(e){H()},!1)}),A&&(A.addEventListener("click",function(e){Y()},!1),A.addEventListener("touchend",function(e){Y()},!1)),null!==T)for(P=0;P<T.length;P++)T[P].num=P,T[P].addEventListener("click",function(e){e.preventDefault(),x(this)},!1),T[P].addEventListener("touchend",function(e){e.preventDefault(),x(this)},!1);function M(e){var t=g.children[0];t.clientHeight>a?(n=Math.round(t.getBoundingClientRect().top),o=-(t.clientHeight-a),(n<=o&&0<e||0<=n&&e<0)&&z(e,w)):z(e,w)}function Y(){0!=p&&(p<L?(noActivePage=p,z(-1,E,!0,0,noActivePage)):(noActivePage=p,z(1,E,!0,0,noActivePage)))}function F(e){l.setAttribute("data-pageslider-progress",Math.round(100/(f-1)*e)),l.setAttribute("data-pageslider-number",e+1),null!==T&&T[e].classList.add("active"),setTimeout(function(){_&&b&&(b.innerHTML=_[e]),B&&(c.hash=B[e])},w-700)}function q(){0==p?z(1,E,!0,h,p):z(-1,w)}function H(){p==h?z(-1,E,!0,0,p):z(1,w)}function x(e){var t=e.num;t<p?(noActivePage=p,z(-1,E,!0,t,noActivePage)):p<t&&(noActivePage=p,z(1,E,!0,t,noActivePage))}function I(){for(var e=h;0<=e;e--)u[e].classList.remove("active"),null!==T&&T[e].classList.remove("active")}function z(e,t,n,o,i){if(t<(d=Date.now())-v){s&&s(),l.classList.add("onanimation"),document.querySelector(".menu__links").classList.contains("showMenu")&&document.querySelector(".menu__links").classList.remove("showMenu");var a=document.querySelector(".popup-one"),c=document.querySelector(".popup-two");a.classList.remove("active-popup"),c.classList.remove("active-popup"),0<e?n?(I(),g=u[p=o],r=u[i],g.classList.add("pt-page-moveFromBottom"),g.classList.add("active"),r.classList.add("active"),r.classList.add("pt-page-ontop"),r.classList.add("pt-page-moveToTop"),F(p),setTimeout(O,w),v=d):p!=h?(I(),g=u[++p],r=u[p].previousElementSibling,g.classList.add("active"),g.classList.add("pt-page-moveFromBottom"),r.classList.add("active"),r.classList.add("pt-page-ontop"),r.classList.add("pt-page-moveToTop"),F(p),setTimeout(O,w),v=d):p==h&&y&&(I(),g=u[p=0],r=u[h],g.classList.add("active"),g.classList.add("pt-page-moveFromBottom"),r.classList.add("active"),r.classList.add("pt-page-ontop"),r.classList.add("pt-page-moveToTop"),F(p),setTimeout(O,w),v=d):e<0&&(n?(I(),g=u[p=o],r=u[i],g.classList.add("active"),g.classList.add("pt-page-ontop"),g.classList.add("pt-page-moveFromTop"),r.classList.add("active"),r.classList.add("pt-page-moveToBottom"),F(p),setTimeout(O,w),v=d):0!=p?(I(),g=u[--p],r=u[p].nextElementSibling,g.classList.add("active"),g.classList.add("pt-page-ontop"),g.classList.add("pt-page-moveFromTop"),r.classList.add("active"),r.classList.add("pt-page-moveToBottom"),F(p),setTimeout(O,w),v=d):0==p&&y&&(I(),g=u[h],r=u[p],p=h,g.classList.add("active"),g.classList.add("pt-page-ontop"),g.classList.add("pt-page-moveFromTop"),r.classList.add("active"),r.classList.add("pt-page-moveToBottom"),F(p),setTimeout(O,w),v=d))}}function O(){for(var e=h;0<=e;e--){l.classList.remove("onanimation");var t=u[e].classList;t.remove("active"),t.remove("pt-page-ontop"),t.remove("pt-page-moveFromBottom"),t.remove("pt-page-moveToTop"),t.remove("pt-page-moveToBottom"),t.remove("pt-page-moveFromTop")}g.classList.add("active")}}!function(){var e,t={last5values:[0,0,0,0,0],memoryAcceleration:[0,0,0],isAcceleration:!1,isStopped:!0,direction:"",delta:"",timer:"",onWheel:"onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"MozMousePixelScroll",addEvent:function(e,t,n){window.addEventListener&&e.addEventListener(t,n,!1),window.attachEvent&&e.attachEvent("on"+t,n)},getDeltaY:function(e){return e.wheelDelta?t.getDeltaY=function(e){return e.wheelDelta/-120}:t.getDeltaY=function(e){return e.deltaY},t.getDeltaY(e)},processDelta:function(e){var t,n=this,o=0;if(n.direction=direction=0<e?"down":"up",n.delta=Math.abs(e),clearTimeout(n.timer),n.timer=setTimeout(function(){n.last5values=[0,0,0,0,0],n.memoryAcceleration=[0,0,0],n.isStopped=!0,n.isAcceleration=!1},200),n.isStopped)n.triggerEvent(),n.isStopped=!1,n.isAcceleration=!0,o=1,n.memoryAcceleration.shift(),n.memoryAcceleration.push(o);else{for(n.last5values.shift(),n.last5values.push(n.delta),t=5;t--;)n.last5values[t-1]<n.last5values[t]&&o++;n.memoryAcceleration.shift(),n.memoryAcceleration.push(o),n.memoryAcceleration[2]<n.memoryAcceleration[1]&&n.memoryAcceleration[1]<n.memoryAcceleration[0]&&(n.isAcceleration=!1),n.memoryAcceleration[2]>n.memoryAcceleration[1]&&n.memoryAcceleration[1]>n.memoryAcceleration[0]&&(n.isAcceleration||(n.isAcceleration=!0,n.triggerEvent()))}},triggerEvent:(e=function(){try{new CustomEvent("IE has CustomEvent, but doesn't support constructor")}catch(e){window.CustomEvent=function(e,t){var n;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n},CustomEvent.prototype=Object.create(window.Event.prototype)}var e=new CustomEvent("scrollUp"),t=new CustomEvent("scrollDown");triggerEvent=function(){"up"===this.direction?window.dispatchEvent(e):window.dispatchEvent(t)},triggerEvent()},n.toString=function(){return e.toString()},n)};function n(){return e.apply(this,arguments)}t.addEvent(document,t.onWheel,function(e){t.processDelta(t.getDeltaY(e))})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9saXdwYWdlc2xpZGVyLmpzIiwid2hlZWwtaW5kaWNhdG9yLmpzIl0sIm5hbWVzIjpbInBhZ2VzbGlkZXIiLCJpdGVtIiwiY2FsbGJhY2siLCJub3dIYW5kbGUiLCIkbm9BY3RpdmVQYWdlIiwiY2xpZW50VG9wTW92ZSIsImNoaWxkcmVuQnRQb3MiLCJ0b3VjaFN0YXJ0UG9pbnQiLCJ0b3VjaE5vd1BvaW50IiwiJGJvZHkiLCJkb2N1bWVudCIsImJvZHkiLCIkcGFnZSIsImNoaWxkcmVuIiwid2luSCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudEhlaWdodCIsIndpbmRvdyIsImlubmVySGVpZ2h0IiwibG9jYXRpb24iLCJoYXNoIiwibGFzdENhbGxIYW5kbGUiLCJwYWdlQWN0aXZlIiwiJHBhZ2VBY3RpdmUiLCJwYWdlQ291bnQiLCJsZW5ndGgiLCJwYWdlTGVuZ3RoIiwicGFnZUNlbnRlciIsIk1hdGgiLCJyb3VuZCIsImFuaW1hdGlvblRpbWUiLCJkZWxheVRpbWUiLCJsb29wIiwiJHRvVG9wIiwiZ2V0RWxlbWVudEJ5SWQiLCIkbmF2TGkiLCJxdWVyeVNlbGVjdG9yIiwiJHRleHRCbG9jayIsIiRwcmV2IiwiJG5leHQiLCJxdWVyeVNlbGVjdG9yQWxsIiwidGV4dEFycmF5IiwiaHJlZkFycmF5IiwiaSIsInRoaXNIYXNoIiwiZ2V0QXR0cmlidXRlIiwicHVzaCIsInJlZ2V4cCIsInRlc3QiLCJjbGFzc0xpc3QiLCJhZGQiLCJzbGlkZXJBY3RpdmUiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJjaGFuZ2VkVG91Y2hlcyIsImNsaWVudFkiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJhYnMiLCJzdHlsZSIsInRyYW5zZm9ybSIsInNjcm9sbFNsaWRlcyIsImtleUNvZGUiLCJub0FjdGl2ZVBhZ2UiLCJmblByZXZOYXYiLCJmb3JFYWNoIiwiZWxlbWVudCIsImZuTmV4dE5hdiIsInRvVG9wIiwibnVtIiwicHJldmVudERlZmF1bHQiLCJjbGlja05hdiIsInRoaXMiLCJkaXJlY3Rpb24iLCIkY2hpbGRyZW4iLCJoYW5kbGUiLCJzZXRBdHRyaWJ1dGUiLCJzZXRUaW1lb3V0IiwiaW5uZXJIVE1MIiwiY2xhc3NDbGVhbiIsInJlbW92ZSIsImRlbHRhIiwiZGVsYXkiLCJuYXYiLCJEYXRlIiwibm93IiwiY29udGFpbnMiLCJwb3B1cE9uZSIsInBvcHVwVHdvIiwiZnVuYyIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJuZXh0RWxlbWVudFNpYmxpbmciLCJwYWdlQ2xhc3NMaXN0IiwiX3RyaWdnZXJFdmVudCIsIndoZWVsSW5kaWNhdG9yIiwibGFzdDV2YWx1ZXMiLCJtZW1vcnlBY2NlbGVyYXRpb24iLCJpc0FjY2VsZXJhdGlvbiIsImlzU3RvcHBlZCIsInRpbWVyIiwib25XaGVlbCIsImFkZEV2ZW50IiwiZWxlbSIsInR5cGUiLCJoYW5kbGVyIiwiYXR0YWNoRXZlbnQiLCJnZXREZWx0YVkiLCJ3aGVlbERlbHRhIiwiZGVsdGFZIiwicHJvY2Vzc0RlbHRhIiwic2VsZiIsInN0ZXBBY2NlbGVyYXRpb24iLCJjbGVhclRpbWVvdXQiLCJ0cmlnZ2VyRXZlbnQiLCJzaGlmdCIsIkN1c3RvbUV2ZW50IiwiZSIsInBhcmFtcyIsImV2dCIsImJ1YmJsZXMiLCJjYW5jZWxhYmxlIiwiZGV0YWlsIiwidW5kZWZpbmVkIiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJFdmVudCIsInNjcm9sbFVwIiwic2Nyb2xsRG93biIsImRpc3BhdGNoRXZlbnQiLCJ0b1N0cmluZyIsImFwcGx5IiwiYXJndW1lbnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxXQUFXQyxFQUFNQyxHQUd6QixJQU9DQyxFQUtBQyxFQUtBQyxFQUNBQyxFQUlBQyxFQUVBQyxFQXZCQUMsRUFBUUMsU0FBU0MsS0FDakJDLEVBRldYLEVBRUdZLFNBQ2RDLEVBQU9KLFNBQVNLLGdCQUFnQkMsY0FBZ0JDLE9BQU9D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bGlkZXIoaXRlbSwgY2FsbGJhY2spIHtcblxuXG5cdHZhciAkdGhpcyA9IGl0ZW0sXG5cdFx0JGJvZHkgPSBkb2N1bWVudC5ib2R5LFxuXHRcdCRwYWdlID0gJHRoaXMuY2hpbGRyZW4sXG5cdFx0d2luSCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgfHwgd2luZG93LmlubmVySGVpZ2h0LFxuXHRcdGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uLFxuXHRcdGhhc2ggPSBsb2NhdGlvbi5oYXNoLFxuXHRcdG5vd1doZWVsLFxuXHRcdG5vd0hhbmRsZSxcblx0XHRsYXN0Q2FsbFdoaWxlID0gMCxcblx0XHRsYXN0Q2FsbEhhbmRsZSA9IDAsXG5cdFx0cGFnZUFjdGl2ZSA9IDAsXG5cdFx0JHBhZ2VBY3RpdmUgPSAkcGFnZVtwYWdlQWN0aXZlXSxcblx0XHQkbm9BY3RpdmVQYWdlLFxuXHRcdHBhZ2VDb3VudCA9ICRwYWdlLmxlbmd0aCAtIDEsXG5cdFx0cGFnZUxlbmd0aCA9ICR0aGlzLmNoaWxkcmVuLmxlbmd0aCxcblx0XHRwYWdlQ2VudGVyID0gTWF0aC5yb3VuZChwYWdlTGVuZ3RoIC8gMiksXG5cdFx0ZGVsdGEsXG5cdFx0Y2xpZW50VG9wTW92ZSxcblx0XHRjaGlsZHJlbkJ0UG9zLFxuXHRcdGRpcmVjdGlvbixcblx0XHRkZWx0YVByZXYgPSAwLFxuXHRcdGNsaWVudFRvcFN0YXJ0LFxuXHRcdHRvdWNoU3RhcnRQb2ludCxcblx0XHR0b3VjaE1vdmVQb2ludCxcblx0XHR0b3VjaE5vd1BvaW50LFxuXHRcdHlBYnMsXG5cblx0XHRhbmltYXRpb25UaW1lID0gLjcsXG5cdFx0ZGVsYXlUaW1lID0gYW5pbWF0aW9uVGltZSAqIDEwMDAsXG5cblx0XHRsb29wID0gZmFsc2UsXG5cdFx0bmF2S2V5bG9vcCA9IHRydWUsXG5cblx0XHQkdG9Ub3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnZXNsaWRlcl9fdG8tdG9wJyksXG5cdFx0JG5hdkxpID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1lbnVfX2xpbmtzIHVsJykuY2hpbGRyZW4sIC8vIGlkIG9mIG1haW4gbmF2ID4gbGlcblx0XHQkdGV4dEJsb2NrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2VzbGlkZXJfX2Zvci10ZXh0JyksXG5cblx0XHQkcHJldiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiLW5hdmtleV9fcHJldicpLFxuXHRcdCRuZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm5leHQtcGFnZV9fdGV4dCcpLFxuXG5cdFx0dGV4dEFycmF5ID0gWydZb3UgY2FuLi4uJywgJy4uLiBhZGQgc29tZSB0ZXh0IC4uLicsICcuLi4gd2hpY2ggZGVwZW5kcyBvZiAuLi4nLCAnLi4uIHNsaWRlIC4uLicsICdPbGl3IFBhZ2UgU2xpZGVyJ10sXG5cdFx0aHJlZkFycmF5ID0gJ2xheW91dCc7XG5cblxuXG5cdGlmIChocmVmQXJyYXkgPT0gJ2xheW91dCcpIHsgLy8gYWRkIGhhc2hlcyBmcm9tIG5hdlxuXHRcdGhyZWZBcnJheSA9IFtdO1xuXG5cdFx0dmFyIHRoaXNIYXNoO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAkbmF2TGkubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRoaXNIYXNoID0gJG5hdkxpW2ldLnF1ZXJ5U2VsZWN0b3IoJ2EnKS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcblxuXHRcdFx0aHJlZkFycmF5LnB1c2godGhpc0hhc2gpO1xuXHRcdH1cblx0fVxuXG5cblxuXHRpZiAoaHJlZkFycmF5KSB7IC8vIHRvIGFjdGl2ZSBwYWdlXG5cdFx0Ly8gcmVhZCBhY3RpdmUgYmxvY2sgZnJvbSBuYXZcblxuXHRcdHZhciB0aGlzSGFzaCxcblx0XHRcdHJlZ2V4cCA9IC9eIy4vO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBocmVmQXJyYXkubGVuZ3RoOyBpKyspIHtcblxuXHRcdFx0aWYgKCEocmVnZXhwLnRlc3QoaHJlZkFycmF5W2ldKSkpIHtcblx0XHRcdFx0dGhpc0hhc2ggPSAnIycgKyBocmVmQXJyYXlbaV07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzSGFzaCA9IGhyZWZBcnJheVtpXTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGhhc2ggPT0gdGhpc0hhc2gpIHtcblx0XHRcdFx0cGFnZUFjdGl2ZSA9IGk7XG5cdFx0XHRcdCRwYWdlQWN0aXZlID0gJHBhZ2VbcGFnZUFjdGl2ZV1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9IGVsc2UgaWYgKGkgPT0gaHJlZkFycmF5Lmxlbmd0aCAtIDEpIHtcblx0XHRcdFx0bG9jYXRpb24uaGFzaCA9IGhyZWZBcnJheVswXTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQkcGFnZUFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcblxuXHRzbGlkZXJBY3RpdmUocGFnZUFjdGl2ZSk7XG5cblxuXG5cdC8vIFRvdWNoXG5cdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHR0b3VjaFN0YXJ0UG9pbnQgPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZO1xuXHRcdGNsaWVudFRvcFN0YXJ0ID0gTWF0aC5yb3VuZCgkcGFnZUFjdGl2ZS5jaGlsZHJlblswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3ApO1xuXG5cdH0sIGZhbHNlKTtcblxuXG5cblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0dG91Y2hNb3ZlUG9pbnQgPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZO1xuXG5cdH0sIGZhbHNlKTtcblxuXG5cblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblxuXHRcdHRvdWNoTm93UG9pbnQgPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXTtcblxuXHRcdHlBYnMgPSBNYXRoLmFicyh0b3VjaFN0YXJ0UG9pbnQgLSB0b3VjaE5vd1BvaW50LmNsaWVudFkpO1xuXG5cdFx0JHBhZ2VBY3RpdmUuc3R5bGUudHJhbnNmb3JtID0gJyc7XG5cblx0XHQvLyB1bmNvbW1lbnQgdG8gYWRkIGEgbGltaXQgYXQgd2hpY2ggc2Nyb2xsaW5nIHRvIHRoZSBuZXh0IHNsaWRlIHdpbGwgbm90IHdvcmtcblxuXHRcdC8vIGlmICh5QWJzID4gd2luSC80KSB7XG5cblx0XHQvLyBcdGlmICh0b3VjaE5vd1BvaW50LmNsaWVudFkgPCB0b3VjaFN0YXJ0UG9pbnQpIHtcblx0XHQvLyBcdFx0ZGVsdGEgPSAxO1xuXHRcdC8vIFx0XHRzY3JvbGxTbGlkZXMoZGVsdGEpO1xuXHRcdC8vIFx0fVxuXHRcdC8vIFx0ZWxzZSB7XG5cdFx0Ly8gXHRcdGRlbHRhID0gLTE7XG5cdFx0Ly8gXHRcdHNjcm9sbFNsaWRlcyhkZWx0YSk7XG5cdFx0Ly8gXHR9XG5cblx0XHQvLyB9XG5cblx0XHRpZiAodG91Y2hOb3dQb2ludC5jbGllbnRZIDwgdG91Y2hTdGFydFBvaW50KSB7XG5cdFx0XHRkZWx0YSA9IDE7XG5cdFx0XHRzY3JvbGxTbGlkZXMoZGVsdGEpO1xuXHRcdH1cblx0XHRlbHNlIHtcblx0XHRcdGRlbHRhID0gLTE7XG5cdFx0XHRzY3JvbGxTbGlkZXMoZGVsdGEpO1xuXHRcdH1cblxuXHR9LCBmYWxzZSk7XG5cblxuXG5cdC8vS2V5Ym9yZFxuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cblx0XHR2YXIga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7XG5cblx0XHRrZXlOYXYoa2V5Q29kZSk7XG5cblx0fSwgZmFsc2UpO1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGxEb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0c2Nyb2xsU2xpZGVzKDEpO1xuXHR9KTtcblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsVXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRzY3JvbGxTbGlkZXMoLTEpO1xuXHR9KTtcblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0d2luSCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0XG5cdH0pO1xuXG5cblxuXHRpZiAoJHByZXYpIHsgLy8gY2xpY2sgb24gXCJwcmV2XCIgYnV0dG9uXG5cblx0XHQkcHJldi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0Zm5QcmV2TmF2KCk7XG5cdFx0fSwgZmFsc2UpO1xuXG5cdFx0JHByZXYuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdGZuUHJldk5hdigpO1xuXHRcdH0sIGZhbHNlKTtcblx0fVxuXG5cdGlmICgkbmV4dCkgeyAvLyBjbGljayBvbiBcIm5leHRcIiBidXR0b25cblxuXHRcdCRuZXh0LmZvckVhY2goZWxlbWVudCA9PiB7XG5cdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdGZuTmV4dE5hdigpO1xuXHRcdFx0fSwgZmFsc2UpO1xuXHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHRmbk5leHROYXYoKTtcblx0XHRcdH0sIGZhbHNlKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmICgkdG9Ub3ApIHsgLy8gY2xpY2sgb24gXCJ0byB0b3BcIiBidXR0b25cblxuXHRcdCR0b1RvcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0dG9Ub3AoKTtcblx0XHR9LCBmYWxzZSk7XG5cblx0XHQkdG9Ub3AuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdHRvVG9wKCk7XG5cdFx0fSwgZmFsc2UpO1xuXHR9XG5cblxuXG5cdGlmICgkbmF2TGkgIT09IG51bGwpIHsgLy8gY2xpY2sgb24gbmF2aWdhdGlvbiBpdGVtXG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRuYXZMaS5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHQkbmF2TGlbaV0ubnVtID0gaTtcblxuXHRcdFx0JG5hdkxpW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGNsaWNrTmF2KHRoaXMpO1xuXHRcdFx0fSwgZmFsc2UpO1xuXG5cdFx0XHQkbmF2TGlbaV0uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0Y2xpY2tOYXYodGhpcyk7XG5cdFx0XHR9LCBmYWxzZSk7XG5cblx0XHR9O1xuXHR9XG5cblx0ZnVuY3Rpb24gc2Nyb2xsU2xpZGVzKGRpcmVjdGlvbikge1xuXG5cdFx0dmFyICRjaGlsZHJlbiA9ICRwYWdlQWN0aXZlLmNoaWxkcmVuWzBdO1xuXG5cdFx0aWYgKCRjaGlsZHJlbi5jbGllbnRIZWlnaHQgPiB3aW5IKSB7XG5cdFx0XHRjbGllbnRUb3BNb3ZlID0gTWF0aC5yb3VuZCgkY2hpbGRyZW4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wKSxcblx0XHRcdFx0Y2hpbGRyZW5CdFBvcyA9IC0oJGNoaWxkcmVuLmNsaWVudEhlaWdodCAtIHdpbkgpO1xuXG5cdFx0XHRpZiAoY2xpZW50VG9wTW92ZSA8PSBjaGlsZHJlbkJ0UG9zICYmIGRpcmVjdGlvbiA+IDApIHtcblx0XHRcdFx0aGFuZGxlKGRpcmVjdGlvbiwgZGVsYXlUaW1lKTtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKGNsaWVudFRvcE1vdmUgPj0gMCAmJiBkaXJlY3Rpb24gPCAwKSB7XG5cdFx0XHRcdGhhbmRsZShkaXJlY3Rpb24sIGRlbGF5VGltZSk7XG5cdFx0XHR9XG5cblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRoYW5kbGUoZGlyZWN0aW9uLCBkZWxheVRpbWUpO1xuXHRcdH1cblx0fVxuXG5cblxuXHRmdW5jdGlvbiB0b1RvcCgpIHtcblxuXHRcdGlmIChwYWdlQWN0aXZlICE9IDApIHtcblxuXHRcdFx0aWYgKHBhZ2VBY3RpdmUgPCBwYWdlQ2VudGVyKSB7XG5cdFx0XHRcdGRlbHRhID0gLTE7XG5cblx0XHRcdFx0bm9BY3RpdmVQYWdlID0gcGFnZUFjdGl2ZTtcblxuXHRcdFx0XHRoYW5kbGUoZGVsdGEsIGFuaW1hdGlvblRpbWUsIHRydWUsIDAsIG5vQWN0aXZlUGFnZSk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRlbHRhID0gMTtcblxuXHRcdFx0XHRub0FjdGl2ZVBhZ2UgPSBwYWdlQWN0aXZlO1xuXG5cdFx0XHRcdGhhbmRsZShkZWx0YSwgYW5pbWF0aW9uVGltZSwgdHJ1ZSwgMCwgbm9BY3RpdmVQYWdlKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXG5cblx0ZnVuY3Rpb24gc2xpZGVyQWN0aXZlKHBhZ2VBY3RpdmUpIHtcblxuXHRcdCRib2R5LnNldEF0dHJpYnV0ZSgnZGF0YS1wYWdlc2xpZGVyLXByb2dyZXNzJywgTWF0aC5yb3VuZCgxMDAgLyAocGFnZUxlbmd0aCAtIDEpICogcGFnZUFjdGl2ZSkpO1xuXHRcdCRib2R5LnNldEF0dHJpYnV0ZSgnZGF0YS1wYWdlc2xpZGVyLW51bWJlcicsIHBhZ2VBY3RpdmUgKyAxKTtcblxuXHRcdGlmICgkbmF2TGkgIT09IG51bGwpIHtcblx0XHRcdCRuYXZMaVtwYWdlQWN0aXZlXS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcblx0XHR9XG5cblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgLy93ZWFrbmVzc2VzXG5cblx0XHRcdGlmICh0ZXh0QXJyYXkgJiYgJHRleHRCbG9jaykge1xuXHRcdFx0XHQkdGV4dEJsb2NrLmlubmVySFRNTCA9IHRleHRBcnJheVtwYWdlQWN0aXZlXTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGhyZWZBcnJheSkge1xuXHRcdFx0XHRsb2NhdGlvbi5oYXNoID0gaHJlZkFycmF5W3BhZ2VBY3RpdmVdO1xuXHRcdFx0fVxuXHRcdH0sIGRlbGF5VGltZSAtIDcwMCk7XG5cdH1cblxuXG5cblx0ZnVuY3Rpb24gZm5QcmV2TmF2KCkge1xuXG5cdFx0aWYgKHBhZ2VBY3RpdmUgPT0gMCkge1xuXG5cdFx0XHRpZiAobmF2S2V5bG9vcCkge1xuXG5cdFx0XHRcdGRlbHRhID0gMTtcblxuXHRcdFx0XHRoYW5kbGUoZGVsdGEsIGFuaW1hdGlvblRpbWUsIHRydWUsIHBhZ2VDb3VudCwgcGFnZUFjdGl2ZSk7XG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRkZWx0YSA9IC0xO1xuXG5cdFx0XHRoYW5kbGUoZGVsdGEsIGRlbGF5VGltZSk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZm5OZXh0TmF2KCkge1xuXG5cdFx0aWYgKHBhZ2VBY3RpdmUgPT0gcGFnZUNvdW50KSB7XG5cblx0XHRcdGlmIChuYXZLZXlsb29wKSB7XG5cblx0XHRcdFx0ZGVsdGEgPSAtMTtcblxuXHRcdFx0XHRoYW5kbGUoZGVsdGEsIGFuaW1hdGlvblRpbWUsIHRydWUsIDAsIHBhZ2VBY3RpdmUpO1xuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0ZGVsdGEgPSAxO1xuXG5cdFx0XHRoYW5kbGUoZGVsdGEsIGRlbGF5VGltZSk7XG5cdFx0fVxuXG5cdH1cblxuXG5cblx0ZnVuY3Rpb24gY2xpY2tOYXYoaXRlbSkge1xuXG5cdFx0dmFyIGkgPSBpdGVtLm51bTtcblxuXHRcdGlmIChwYWdlQWN0aXZlID4gaSkge1xuXHRcdFx0ZGVsdGEgPSAtMTtcblxuXHRcdFx0bm9BY3RpdmVQYWdlID0gcGFnZUFjdGl2ZTtcblxuXHRcdFx0aGFuZGxlKGRlbHRhLCBhbmltYXRpb25UaW1lLCB0cnVlLCBpLCBub0FjdGl2ZVBhZ2UpO1xuXG5cdFx0fSBlbHNlIGlmIChwYWdlQWN0aXZlIDwgaSkge1xuXHRcdFx0ZGVsdGEgPSAxO1xuXG5cdFx0XHRub0FjdGl2ZVBhZ2UgPSBwYWdlQWN0aXZlO1xuXG5cdFx0XHRoYW5kbGUoZGVsdGEsIGFuaW1hdGlvblRpbWUsIHRydWUsIGksIG5vQWN0aXZlUGFnZSk7XG5cdFx0fVxuXHR9XG5cblxuXG5cdGZ1bmN0aW9uIGtleU5hdihrZXlDb2RlKSB7XG5cblx0XHRpZiAoa2V5Q29kZSA9PSAzOCkge1xuXHRcdFx0Ly8gMzggLSBpcyBhcnJvdyB0b3Bcblx0XHRcdC8vIDg3IC0gaXMgbGV0dGVyICdXJ1xuXG5cdFx0XHRkZWx0YSA9IC0xO1xuXG5cdFx0XHRub0FjdGl2ZVBhZ2UgPSBwYWdlQWN0aXZlO1xuXG5cdFx0XHRzY3JvbGxTbGlkZXMoZGVsdGEpO1xuXG5cdFx0fSBlbHNlIGlmIChrZXlDb2RlID09IDQwKSB7XG5cdFx0XHQvLyA0MCAtIGlzIGFycm93IGJvdHRvbVxuXHRcdFx0Ly8gODMgLSBpcyBsZXR0ZXIgJ1MnXG5cblx0XHRcdGRlbHRhID0gMTtcblx0XHRcdFxuXHRcdFx0bm9BY3RpdmVQYWdlID0gcGFnZUFjdGl2ZTtcblxuXHRcdFx0c2Nyb2xsU2xpZGVzKGRlbHRhKTtcblx0XHR9XG5cdH1cblxuXG5cblx0Ly8gZGVsZXRlIGFsbCBjbGFzcyBhY3RpdmVcblx0ZnVuY3Rpb24gY2xhc3NDbGVhbigpIHtcblxuXHRcdGZvciAodmFyIGkgPSBwYWdlQ291bnQ7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHQkcGFnZVtpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblxuXHRcdFx0aWYgKCRuYXZMaSAhPT0gbnVsbCkge1xuXHRcdFx0XHQkbmF2TGlbaV0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cdFx0XHR9XG5cdFx0fTtcblx0fVxuXG5cblxuXHRmdW5jdGlvbiBoYW5kbGUoZGVsdGEsIGRlbGF5LCBuYXYsIGksIG5vQWN0aXZlUGFnZSkge1xuXG5cdFx0bm93SGFuZGxlID0gRGF0ZS5ub3coKTtcblxuXHRcdGlmIChub3dIYW5kbGUgLSBsYXN0Q2FsbEhhbmRsZSA+IGRlbGF5KSB7XG5cblx0XHRcdGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcblxuXHRcdFx0JGJvZHkuY2xhc3NMaXN0LmFkZCgnb25hbmltYXRpb24nKTtcblxuXHRcdFx0aWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51X19saW5rcycpLmNsYXNzTGlzdC5jb250YWlucygnc2hvd01lbnUnKSkge1xuXHRcdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudV9fbGlua3MnKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93TWVudScpO1xuXHRcdFx0fVxuXG5cblx0XHRcdGxldCBwb3B1cE9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1vbmUnKTtcblx0XHRcdGxldCBwb3B1cFR3byA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC10d28nKTtcblxuXHRcdFx0cG9wdXBPbmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlLXBvcHVwJyk7XG5cdFx0XHRwb3B1cFR3by5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUtcG9wdXAnKTtcblxuXHRcdFx0aWYgKGRlbHRhID4gMCkge1xuXG5cdFx0XHRcdGlmIChuYXYpIHtcblxuXHRcdFx0XHRcdGNsYXNzQ2xlYW4oKTtcblxuXHRcdFx0XHRcdHBhZ2VBY3RpdmUgPSBpO1xuXG5cdFx0XHRcdFx0JHBhZ2VBY3RpdmUgPSAkcGFnZVtwYWdlQWN0aXZlXSxcblx0XHRcdFx0XHRcdCRub0FjdGl2ZVBhZ2UgPSAkcGFnZVtub0FjdGl2ZVBhZ2VdO1xuXG5cdFx0XHRcdFx0Ly8gZm9yIGllXG5cdFx0XHRcdFx0JHBhZ2VBY3RpdmUuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1tb3ZlRnJvbUJvdHRvbScpO1xuXHRcdFx0XHRcdCRwYWdlQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXG5cdFx0XHRcdFx0JG5vQWN0aXZlUGFnZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcblx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlLmNsYXNzTGlzdC5hZGQoJ3B0LXBhZ2Utb250b3AnKTtcblx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlLmNsYXNzTGlzdC5hZGQoJ3B0LXBhZ2UtbW92ZVRvVG9wJyk7XG5cblx0XHRcdFx0XHRzbGlkZXJBY3RpdmUocGFnZUFjdGl2ZSk7XG5cblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmMsIGRlbGF5VGltZSk7XG5cblx0XHRcdFx0XHRsYXN0Q2FsbEhhbmRsZSA9IG5vd0hhbmRsZTtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0aWYgKCEocGFnZUFjdGl2ZSA9PSBwYWdlQ291bnQpKSB7XG5cblx0XHRcdFx0XHRcdGNsYXNzQ2xlYW4oKTtcblxuXHRcdFx0XHRcdFx0cGFnZUFjdGl2ZSsrO1xuXG5cdFx0XHRcdFx0XHQkcGFnZUFjdGl2ZSA9ICRwYWdlW3BhZ2VBY3RpdmVdLFxuXHRcdFx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlID0gJHBhZ2VbcGFnZUFjdGl2ZV0ucHJldmlvdXNFbGVtZW50U2libGluZztcblxuXHRcdFx0XHRcdFx0Ly8gZm9yIGllXG5cdFx0XHRcdFx0XHQkcGFnZUFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcblx0XHRcdFx0XHRcdCRwYWdlQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ3B0LXBhZ2UtbW92ZUZyb21Cb3R0b20nKTtcblxuXHRcdFx0XHRcdFx0JG5vQWN0aXZlUGFnZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcblx0XHRcdFx0XHRcdCRub0FjdGl2ZVBhZ2UuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1vbnRvcCcpO1xuXHRcdFx0XHRcdFx0JG5vQWN0aXZlUGFnZS5jbGFzc0xpc3QuYWRkKCdwdC1wYWdlLW1vdmVUb1RvcCcpO1xuXG5cdFx0XHRcdFx0XHRzbGlkZXJBY3RpdmUocGFnZUFjdGl2ZSk7XG5cblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuYywgZGVsYXlUaW1lKTtcblxuXHRcdFx0XHRcdFx0bGFzdENhbGxIYW5kbGUgPSBub3dIYW5kbGU7XG5cblx0XHRcdFx0XHR9IGVsc2UgaWYgKHBhZ2VBY3RpdmUgPT0gcGFnZUNvdW50ICYmIGxvb3ApIHtcblxuXHRcdFx0XHRcdFx0Y2xhc3NDbGVhbigpO1xuXG5cdFx0XHRcdFx0XHRwYWdlQWN0aXZlID0gMDtcblxuXHRcdFx0XHRcdFx0JHBhZ2VBY3RpdmUgPSAkcGFnZVtwYWdlQWN0aXZlXSxcblx0XHRcdFx0XHRcdFx0JG5vQWN0aXZlUGFnZSA9ICRwYWdlW3BhZ2VDb3VudF07XG5cblx0XHRcdFx0XHRcdC8vIGZvciBpZVxuXHRcdFx0XHRcdFx0JHBhZ2VBY3RpdmUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG5cdFx0XHRcdFx0XHQkcGFnZUFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdwdC1wYWdlLW1vdmVGcm9tQm90dG9tJyk7XG5cblx0XHRcdFx0XHRcdCRub0FjdGl2ZVBhZ2UuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG5cdFx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlLmNsYXNzTGlzdC5hZGQoJ3B0LXBhZ2Utb250b3AnKTtcblx0XHRcdFx0XHRcdCRub0FjdGl2ZVBhZ2UuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1tb3ZlVG9Ub3AnKTtcblxuXHRcdFx0XHRcdFx0c2xpZGVyQWN0aXZlKHBhZ2VBY3RpdmUpO1xuXG5cdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmMsIGRlbGF5VGltZSk7XG5cblx0XHRcdFx0XHRcdGxhc3RDYWxsSGFuZGxlID0gbm93SGFuZGxlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChkZWx0YSA8IDApIHtcblxuXHRcdFx0XHRpZiAobmF2KSB7XG5cblx0XHRcdFx0XHRjbGFzc0NsZWFuKCk7XG5cblx0XHRcdFx0XHRwYWdlQWN0aXZlID0gaTtcblxuXHRcdFx0XHRcdCRwYWdlQWN0aXZlID0gJHBhZ2VbcGFnZUFjdGl2ZV0sXG5cdFx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlID0gJHBhZ2Vbbm9BY3RpdmVQYWdlXTtcblxuXHRcdFx0XHRcdC8vIGZvciBpZVxuXHRcdFx0XHRcdCRwYWdlQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdCRwYWdlQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ3B0LXBhZ2Utb250b3AnKTtcblx0XHRcdFx0XHQkcGFnZUFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdwdC1wYWdlLW1vdmVGcm9tVG9wJyk7XG5cblx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdCRub0FjdGl2ZVBhZ2UuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1tb3ZlVG9Cb3R0b20nKTtcblxuXHRcdFx0XHRcdHNsaWRlckFjdGl2ZShwYWdlQWN0aXZlKTtcblxuXHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuYywgZGVsYXlUaW1lKTtcblxuXHRcdFx0XHRcdGxhc3RDYWxsSGFuZGxlID0gbm93SGFuZGxlO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRpZiAoIShwYWdlQWN0aXZlID09IDApKSB7XG5cblx0XHRcdFx0XHRcdGNsYXNzQ2xlYW4oKTtcblxuXHRcdFx0XHRcdFx0cGFnZUFjdGl2ZS0tO1xuXG5cdFx0XHRcdFx0XHQkcGFnZUFjdGl2ZSA9ICRwYWdlW3BhZ2VBY3RpdmVdLFxuXHRcdFx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlID0gJHBhZ2VbcGFnZUFjdGl2ZV0ubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG5cdFx0XHRcdFx0XHQvLyBmb3IgaWVcblx0XHRcdFx0XHRcdCRwYWdlQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdFx0JHBhZ2VBY3RpdmUuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1vbnRvcCcpO1xuXHRcdFx0XHRcdFx0JHBhZ2VBY3RpdmUuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1tb3ZlRnJvbVRvcCcpO1xuXG5cdFx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdFx0JG5vQWN0aXZlUGFnZS5jbGFzc0xpc3QuYWRkKCdwdC1wYWdlLW1vdmVUb0JvdHRvbScpO1xuXG5cdFx0XHRcdFx0XHRzbGlkZXJBY3RpdmUocGFnZUFjdGl2ZSk7XG5cblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuYywgZGVsYXlUaW1lKTtcblxuXHRcdFx0XHRcdFx0bGFzdENhbGxIYW5kbGUgPSBub3dIYW5kbGU7XG5cblx0XHRcdFx0XHR9IGVsc2UgaWYgKHBhZ2VBY3RpdmUgPT0gMCAmJiBsb29wKSB7XG5cblx0XHRcdFx0XHRcdGNsYXNzQ2xlYW4oKTtcblxuXHRcdFx0XHRcdFx0JHBhZ2VBY3RpdmUgPSAkcGFnZVtwYWdlQ291bnRdLFxuXHRcdFx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlID0gJHBhZ2VbcGFnZUFjdGl2ZV07XG5cblx0XHRcdFx0XHRcdHBhZ2VBY3RpdmUgPSBwYWdlQ291bnQ7IC8vIGl0IHNob3VsZCBiZSBoZXJlIVxuXG5cdFx0XHRcdFx0XHQvLyBmb3IgaWVcblx0XHRcdFx0XHRcdCRwYWdlQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdFx0JHBhZ2VBY3RpdmUuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1vbnRvcCcpO1xuXHRcdFx0XHRcdFx0JHBhZ2VBY3RpdmUuY2xhc3NMaXN0LmFkZCgncHQtcGFnZS1tb3ZlRnJvbVRvcCcpO1xuXG5cdFx0XHRcdFx0XHQkbm9BY3RpdmVQYWdlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHRcdFx0XHRcdFx0JG5vQWN0aXZlUGFnZS5jbGFzc0xpc3QuYWRkKCdwdC1wYWdlLW1vdmVUb0JvdHRvbScpO1xuXG5cdFx0XHRcdFx0XHRzbGlkZXJBY3RpdmUocGFnZUFjdGl2ZSk7XG5cblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuYywgZGVsYXlUaW1lKTtcblxuXHRcdFx0XHRcdFx0bGFzdENhbGxIYW5kbGUgPSBub3dIYW5kbGU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblxuXG5cdGZ1bmN0aW9uIGZ1bmMoKSB7IC8vIGFkZCBjbGFzcyBmb3IgYW5pbWF0aW9uIGFuZFxuXHRcdC8vYWRkIGFjdGl2ZSBjbGFzcyBmb3IgbmV3IHNsaWRlclxuXG5cdFx0Zm9yICh2YXIgaSA9IHBhZ2VDb3VudDsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdCRib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ29uYW5pbWF0aW9uJyk7XG5cblx0XHRcdHZhciBwYWdlQ2xhc3NMaXN0ID0gJHBhZ2VbaV0uY2xhc3NMaXN0O1xuXG5cdFx0XHQvLyBmb3IgaWVcblx0XHRcdHBhZ2VDbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblx0XHRcdHBhZ2VDbGFzc0xpc3QucmVtb3ZlKCdwdC1wYWdlLW9udG9wJyk7XG5cdFx0XHRwYWdlQ2xhc3NMaXN0LnJlbW92ZSgncHQtcGFnZS1tb3ZlRnJvbUJvdHRvbScpO1xuXHRcdFx0cGFnZUNsYXNzTGlzdC5yZW1vdmUoJ3B0LXBhZ2UtbW92ZVRvVG9wJyk7XG5cdFx0XHRwYWdlQ2xhc3NMaXN0LnJlbW92ZSgncHQtcGFnZS1tb3ZlVG9Cb3R0b20nKTtcblx0XHRcdHBhZ2VDbGFzc0xpc3QucmVtb3ZlKCdwdC1wYWdlLW1vdmVGcm9tVG9wJyk7XG5cdFx0fTtcblxuXHRcdCRwYWdlQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHR9XG59O1xuXG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgdmFyIHdoZWVsSW5kaWNhdG9yID0ge1xuICAgICAgICBsYXN0NXZhbHVlczogWyAwLCAwLCAwLCAwLCAwIF0sXG4gICAgICAgIG1lbW9yeUFjY2VsZXJhdGlvbjogWyAwLCAwICwgMCBdLFxuICAgICAgICBpc0FjY2VsZXJhdGlvbjogZmFsc2UsXG4gICAgICAgIGlzU3RvcHBlZDogdHJ1ZSxcbiAgICAgICAgZGlyZWN0aW9uOiAnJyxcbiAgICAgICAgZGVsdGE6ICcnLFxuICAgICAgICB0aW1lcjogJycsXG4gICAgICAgIG9uV2hlZWw6ICgnb253aGVlbCcgaW4gZG9jdW1lbnQpID8gJ3doZWVsJyA6IFxuICAgICAgICAgICAgICAgICAoJ29ubW91c2V3aGVlbCcgaW4gZG9jdW1lbnQpID8gJ21vdXNld2hlZWwnIDpcbiAgICAgICAgICAgICAgICAgJ01vek1vdXNlUGl4ZWxTY3JvbGwnLFxuXG4gICAgICAgIGFkZEV2ZW50OiBmdW5jdGlvbihlbGVtLCB0eXBlLCBoYW5kbGVyKXtcbiAgICAgICAgICAgIGlmKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHdpbmRvdy5hdHRhY2hFdmVudCkge1xuICAgICAgICAgICAgICAgIGVsZW0uYXR0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGhhbmRsZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGdldERlbHRhWTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIGlmKGV2ZW50LndoZWVsRGVsdGEpIHtcbiAgICAgICAgICAgICAgICB3aGVlbEluZGljYXRvci5nZXREZWx0YVkgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnQud2hlZWxEZWx0YSAvIC0xMjA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aGVlbEluZGljYXRvci5nZXREZWx0YVkgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnQuZGVsdGFZO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB3aGVlbEluZGljYXRvci5nZXREZWx0YVkoZXZlbnQpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHByb2Nlc3NEZWx0YTogZnVuY3Rpb24oZGVsdGFZKSAge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgICAgIHN0ZXBBY2NlbGVyYXRpb24gPSAwLCBpO1xuXG4gICAgICAgICAgICBzZWxmLmRpcmVjdGlvbiA9IGRlbHRhWSA+IDAgPyBkaXJlY3Rpb24gPSAnZG93bicgOiBkaXJlY3Rpb24gPSAndXAnO1xuICAgICAgICAgICAgc2VsZi5kZWx0YSA9IE1hdGguYWJzKGRlbHRhWSk7XG5cbiAgICAgICAgICAgIGNsZWFyVGltZW91dChzZWxmLnRpbWVyKTtcblxuICAgICAgICAgICAgc2VsZi50aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5sYXN0NXZhbHVlcyA9IFsgMCwgMCwgMCwgMCwgMCBdO1xuICAgICAgICAgICAgICAgIHNlbGYubWVtb3J5QWNjZWxlcmF0aW9uID0gWyAwLCAwICwgMCBdO1xuICAgICAgICAgICAgICAgIHNlbGYuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzZWxmLmlzQWNjZWxlcmF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB9LCAyMDApO1xuXG4gICAgICAgICAgICBpZihzZWxmLmlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgIHNlbGYudHJpZ2dlckV2ZW50KCk7XG4gICAgICAgICAgICAgICAgc2VsZi5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBzZWxmLmlzQWNjZWxlcmF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzdGVwQWNjZWxlcmF0aW9uID0gMTtcblxuICAgICAgICAgICAgICAgIHNlbGYubWVtb3J5QWNjZWxlcmF0aW9uLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgc2VsZi5tZW1vcnlBY2NlbGVyYXRpb24ucHVzaChzdGVwQWNjZWxlcmF0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5sYXN0NXZhbHVlcy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgIHNlbGYubGFzdDV2YWx1ZXMucHVzaChzZWxmLmRlbHRhKTtcblxuICAgICAgICAgICAgICAgIGZvcihpID0gNTsgaS0tOyBpID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZi5sYXN0NXZhbHVlc1tpIC0gMV0gPCBzZWxmLmxhc3Q1dmFsdWVzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwQWNjZWxlcmF0aW9uKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzZWxmLm1lbW9yeUFjY2VsZXJhdGlvbi5zaGlmdCgpO1xuICAgICAgICAgICAgICAgIHNlbGYubWVtb3J5QWNjZWxlcmF0aW9uLnB1c2goc3RlcEFjY2VsZXJhdGlvbik7XG5cbiAgICAgICAgICAgICAgICBpZiggKHNlbGYubWVtb3J5QWNjZWxlcmF0aW9uWzJdIDwgc2VsZi5tZW1vcnlBY2NlbGVyYXRpb25bMV0pICYmXG4gICAgICAgICAgICAgICAgICAgIChzZWxmLm1lbW9yeUFjY2VsZXJhdGlvblsxXSA8IHNlbGYubWVtb3J5QWNjZWxlcmF0aW9uWzBdKSkge1xuICAgICAgICAgICAgICAgICAgICAvL9Cf0YDQvtC40LfQvtGI0LvQviDQt9Cw0YLRg9GF0LDQvdC40LVcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pc0FjY2VsZXJhdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKCAoc2VsZi5tZW1vcnlBY2NlbGVyYXRpb25bMl0gPiBzZWxmLm1lbW9yeUFjY2VsZXJhdGlvblsxXSkgJiZcbiAgICAgICAgICAgICAgICAgICAgKHNlbGYubWVtb3J5QWNjZWxlcmF0aW9uWzFdID4gc2VsZi5tZW1vcnlBY2NlbGVyYXRpb25bMF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIC8v0J/RgNC+0LjQt9C+0YjQu9C+INGD0YHQutC+0YDQtdC90LjQtVxuICAgICAgICAgICAgICAgICAgICBpZighc2VsZi5pc0FjY2VsZXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5pc0FjY2VsZXJhdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnRyaWdnZXJFdmVudCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHRyaWdnZXJFdmVudDogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbmV3IEN1c3RvbUV2ZW50KFwiSUUgaGFzIEN1c3RvbUV2ZW50LCBidXQgZG9lc24ndCBzdXBwb3J0IGNvbnN0cnVjdG9yXCIpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuXG4gICAgICAgICAgICAgICAgd2luZG93LkN1c3RvbUV2ZW50ID0gZnVuY3Rpb24oZXZlbnQsIHBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZ0O1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSBwYXJhbXMgfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnViYmxlczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpO1xuICAgICAgICAgICAgICAgICAgICBldnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXZ0O1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBDdXN0b21FdmVudC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHdpbmRvdy5FdmVudC5wcm90b3R5cGUpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIHNjcm9sbFVwICAgID0gbmV3IEN1c3RvbUV2ZW50KCdzY3JvbGxVcCcpLFxuICAgICAgICAgICAgICAgIHNjcm9sbERvd24gID0gbmV3IEN1c3RvbUV2ZW50KCdzY3JvbGxEb3duJyk7XG5cbiAgICAgICAgICAgIHRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID09PSAndXAnID8gd2luZG93LmRpc3BhdGNoRXZlbnQoc2Nyb2xsVXApIDogd2luZG93LmRpc3BhdGNoRXZlbnQoc2Nyb2xsRG93bik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgd2hlZWxJbmRpY2F0b3IuYWRkRXZlbnQoZG9jdW1lbnQsIHdoZWVsSW5kaWNhdG9yLm9uV2hlZWwsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHdoZWVsSW5kaWNhdG9yLnByb2Nlc3NEZWx0YSh3aGVlbEluZGljYXRvci5nZXREZWx0YVkoZXZlbnQpKTtcbiAgICB9KTtcbn0oKSk7Il19
